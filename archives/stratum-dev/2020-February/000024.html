<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [stratum-dev] [brigade-p4] Stratum pre-built container
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:stratum-dev%40lists.stratumproject.org?Subject=Re%3A%20%5Bstratum-dev%5D%20%5Bbrigade-p4%5D%20Stratum%20pre-built%20container&In-Reply-To=%3CCAOyFVR1VeaA%2BdPWT6x%3DyjX-qpqYV-UMMOMSvLrMRdLWWVqZFYQ%40mail.gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=utf-8">
   <LINK REL="Previous"  HREF="000027.html">
   <LINK REL="Next"  HREF="000028.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[stratum-dev] [brigade-p4] Stratum pre-built container</H1>
    <B>Yi Tseng</B> 
    <A HREF="mailto:stratum-dev%40lists.stratumproject.org?Subject=Re%3A%20%5Bstratum-dev%5D%20%5Bbrigade-p4%5D%20Stratum%20pre-built%20container&In-Reply-To=%3CCAOyFVR1VeaA%2BdPWT6x%3DyjX-qpqYV-UMMOMSvLrMRdLWWVqZFYQ%40mail.gmail.com%3E"
       TITLE="[stratum-dev] [brigade-p4] Stratum pre-built container">yi at opennetworking.org
       </A><BR>
    <I>Thu Feb 27 18:57:41 UTC 2020</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="000027.html">[stratum-dev] [brigade-p4] Stratum pre-built container
</A></li>
        <LI>Next message (by thread): <A HREF="000028.html">[stratum-dev] [brigade-p4] Stratum pre-built container
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#24">[ date ]</a>
              <a href="thread.html#24">[ thread ]</a>
              <a href="subject.html#24">[ subject ]</a>
              <a href="author.html#24">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hello, please see my reply *inline*

On Tue, Feb 25, 2020 at 1:21 AM Deval Bhamare &lt;<A HREF="https://lists.stratumproject.org/listinfo/stratum-dev">Deval.Bhamare at kau.se</A>&gt; wrote:

&gt;<i> Dear Yi,
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> I appreciate your valuable input. I tried to build the  Stratum directly
</I>&gt;<i> on the machine as well. It gave me an error. Details are below:
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> *1. Build Stratum from scratch*: I have BF SDE 8.9.0 and I execute the
</I>&gt;<i> command (first I executed it without
</I>&gt;<i> incompatible_bzl_disallow_load_after_statement=false and it asked me to
</I>&gt;<i> include that option in command):
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> bazel build //stratum/hal/bin/barefoot:stratum_bf --define
</I>&gt;<i> phal_with_onlp=false --define sde_ver=8.9.0
</I>&gt;<i> --incompatible_bzl_disallow_load_after_statement=false
</I>&gt;<i>
</I>&gt;<i>
</I>*Please use the stratum build development environment to build the Stratum.
We only support Bazel 0.23.2 now. And will move to 2.0 in the future.*
*<A HREF="https://github.com/stratum/stratum#development-environment">https://github.com/stratum/stratum#development-environment</A>
&lt;<A HREF="https://github.com/stratum/stratum#development-environment">https://github.com/stratum/stratum#development-environment</A>&gt;*


&gt;<i>
</I>&gt;<i> It gave me the error:
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> *ERROR:* /home/tofino/.cache/bazel/_bazel_tofino/f6d313d4f595c91e594b2a1b1a2579ea/external/io_bazel_rules_python/python/pip.bzl:39:25:
</I>&gt;<i> Traceback (most recent call last):
</I>&gt;<i> File
</I>&gt;<i> &quot;/home/tofino/.cache/bazel/_bazel_tofino/f6d313d4f595c91e594b2a1b1a2579ea/external/io_bazel_rules_python/python/pip.bzl&quot;,
</I>&gt;<i> line 37
</I>&gt;<i> repository_rule(&lt;2 more arguments&gt;)
</I>&gt;<i> File
</I>&gt;<i> &quot;/home/tofino/.cache/bazel/_bazel_tofino/f6d313d4f595c91e594b2a1b1a2579ea/external/io_bazel_rules_python/python/pip.bzl&quot;,
</I>&gt;<i> line 39, in repository_rule
</I>&gt;<i> attr.label(allow_files = True, &lt;2 more arguments&gt;)
</I>&gt;<i> 'single_file' is no longer supported. use allow_single_file instead. You
</I>&gt;<i> can use --incompatible_disable_deprecated_attr_params=false to temporarily
</I>&gt;<i> disable this check.
</I>&gt;<i> *ERROR:* error loading package '': Extension file 'python/pip.bzl' has
</I>&gt;<i> errors
</I>&gt;<i> *ERROR:* error loading package '': Extension file 'python/pip.bzl' has
</I>&gt;<i> errors
</I>&gt;<i> INFO: Elapsed time: 0.101s
</I>&gt;<i> INFO: 0 processes.
</I>&gt;<i> *FAILED:* Build did NOT complete successfully (0 packages loaded)
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> I also tried to build the Docker Image manually.
</I>&gt;<i>
</I>&gt;<i> *3. Build the docker image manually*: I tried to execute the command
</I>&gt;<i> below, as per my kernel and SDE
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> ./build-stratum-bf-container.sh bf-sde-8.9.0.tar linux-4.4.173.tar.gz
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> However, it failed with error below. Where can I find *Linux ONL tar* for
</I>&gt;<i> my linux kernel?
</I>&gt;<i> Error:
</I>&gt;<i>
</I>
*You should be able to find it from /usr/src/linux-headers-[your linux
kernel version]. *



&gt;<i> make: Entering directory '/usr/src/kernel-headers'
</I>&gt;<i>
</I>&gt;<i>   ERROR: Kernel configuration is invalid.
</I>&gt;<i>          include/generated/autoconf.h or include/config/auto.conf are
</I>&gt;<i> missing.
</I>&gt;<i>          Run 'make oldconfig &amp;&amp; make prepare' on kernel src to fix it.
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>   WARNING: Symbol version dump ./Module.symvers
</I>&gt;<i>            is missing; modules will have no dependencies and modversions.
</I>&gt;<i>
</I>&gt;<i>   Building modules, stage 2.
</I>&gt;<i> scripts/Makefile.modpost:42: include/config/auto.conf: No such file or
</I>&gt;<i> directory
</I>&gt;<i> make[1]: *** No rule to make target 'include/config/auto.conf'.  Stop.
</I>&gt;<i> Makefile:1439: recipe for target 'modules' failed
</I>&gt;<i> make: Leaving directory '/usr/src/kernel-headers'
</I>&gt;<i> make: *** [modules] Error 2
</I>&gt;<i> The command '/bin/sh -c make -C /usr/src/kernel-headers M=$KDRV_DIR
</I>&gt;<i> src=$KDRV_DIR modules &amp;&amp;     mv $KDRV_DIR/bf_kdrv.ko
</I>&gt;<i> $SDE_INSTALL/lib/modules/bf_kdrv.ko' returned a non-zero code: 2
</I>&gt;<i>
</I>&gt;<i> Thanks,
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> Deval.
</I>&gt;<i> ------------------------------
</I>&gt;<i> *From:* Yi Tseng &lt;<A HREF="https://lists.stratumproject.org/listinfo/stratum-dev">yi at opennetworking.org</A>&gt;
</I>&gt;<i> *Sent:* Tuesday, February 25, 2020 2:07:35 AM
</I>&gt;<i> *To:* Deval Bhamare
</I>&gt;<i> *Cc:* <A HREF="https://lists.stratumproject.org/listinfo/stratum-dev">stratum-dev at lists.stratumproject.org</A>
</I>&gt;<i> *Subject:* Re: [brigade-p4] Stratum pre-built container
</I>&gt;<i>
</I>&gt;<i> [<A HREF="https://lists.stratumproject.org/listinfo/stratum-dev">+stratum-dev at lists.stratumproject.org</A>
</I>&gt;<i> &lt;<A HREF="https://lists.stratumproject.org/listinfo/stratum-dev">stratum-dev at lists.stratumproject.org</A>&gt;, remove p4-brigade list]
</I>&gt;<i>
</I>&gt;<i> Hi Deval,
</I>&gt;<i>
</I>&gt;<i> The public container images include a specific Barefoot Linux kernel
</I>&gt;<i> module.
</I>&gt;<i>
</I>&gt;<i> Now we only compile the module for kernels from OpenNetworkLiunx (3.16,
</I>&gt;<i> 4.9, and 4.14)
</I>&gt;<i>
</I>&gt;<i> If you want to run Stratum on different kernel (4.4.0-173-generic), you
</I>&gt;<i> need to compile the Barefoot SDE with the kernel header and run Stratum
</I>&gt;<i> directly on the OS
</I>&gt;<i>
</I>&gt;<i> I've created a GitHub issue to support this request. And will make a PR to
</I>&gt;<i> support this case.
</I>&gt;<i> <A HREF="https://github.com/stratum/stratum/issues/140">https://github.com/stratum/stratum/issues/140</A>
</I>&gt;<i>
</I>&gt;<i> Yi
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> On Mon, Feb 24, 2020 at 3:25 PM Carmelo Cascone &lt;
</I>&gt;<i> <A HREF="https://lists.stratumproject.org/listinfo/stratum-dev">carmelo at opennetworking.org</A>&gt; wrote:
</I>&gt;<i>
</I>&gt;&gt;<i> Hi Deval,
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> I suggest you ask on the stratum-dev mailing list or Slack channel:
</I>&gt;&gt;<i> <A HREF="https://wiki.opennetworking.org/display/COM/Stratum">https://wiki.opennetworking.org/display/COM/Stratum</A>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> This mailing list is for discussions related to P4/P4Runtime support in
</I>&gt;&gt;<i> ONOS.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Thanks
</I>&gt;&gt;<i> Carmelo
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> On Feb 24, 2020, at 6:53 AM, Deval Bhamare &lt;<A HREF="https://lists.stratumproject.org/listinfo/stratum-dev">Deval.Bhamare at kau.se</A>&gt; wrote:
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Hi,
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> I am trying to find Stratum pre-built docker image for Linux
</I>&gt;&gt;<i> 4.4.0-173-generic x86_64 , however couldn't find it. Can you please tell me
</I>&gt;&gt;<i> whether Stratum is not supported on Generic and only runs on ONL version?
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> I tried *stratumproject/stratum-bf:8.9.1-4.14.49-OpenNetworkLinux* , but
</I>&gt;&gt;<i> it failed with error:
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> cat: /etc/onl/platform: No such file or directory
</I>&gt;&gt;<i> Use default flag file
</I>&gt;&gt;<i> Cannot find /usr/local/share/stratum/.json
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Maybe because the Linux doesn't support ONL? What may be the solution?
</I>&gt;&gt;<i> Please let me know.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Thanks,
</I>&gt;&gt;<i> Deval
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> --
</I>&gt;&gt;<i> You received this message because you are subscribed to the Google Groups
</I>&gt;&gt;<i> &quot;P4 brigade&quot; group.
</I>&gt;&gt;<i> To unsubscribe from this group and stop receiving emails from it, send an
</I>&gt;&gt;<i> email to <A HREF="https://lists.stratumproject.org/listinfo/stratum-dev">brigade-p4+unsubscribe at onosproject.org.</A>
</I>&gt;&gt;<i> To view this discussion on the web visit
</I>&gt;&gt;<i> <A HREF="https://groups.google.com/a/onosproject.org/d/msgid/brigade-p4/3219e60081e54a23950b45fb513ca36e%40kau.se">https://groups.google.com/a/onosproject.org/d/msgid/brigade-p4/3219e60081e54a23950b45fb513ca36e%40kau.se</A>
</I>&gt;&gt;<i> &lt;<A HREF="https://groups.google.com/a/onosproject.org/d/msgid/brigade-p4/3219e60081e54a23950b45fb513ca36e%40kau.se?utm_medium=email&amp;utm_source=footer">https://groups.google.com/a/onosproject.org/d/msgid/brigade-p4/3219e60081e54a23950b45fb513ca36e%40kau.se?utm_medium=email&amp;utm_source=footer</A>&gt;
</I>&gt;&gt;<i> .
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> --
</I>&gt;&gt;<i> You received this message because you are subscribed to the Google Groups
</I>&gt;&gt;<i> &quot;P4 brigade&quot; group.
</I>&gt;&gt;<i> To unsubscribe from this group and stop receiving emails from it, send an
</I>&gt;&gt;<i> email to <A HREF="https://lists.stratumproject.org/listinfo/stratum-dev">brigade-p4+unsubscribe at onosproject.org.</A>
</I>&gt;&gt;<i> To view this discussion on the web visit
</I>&gt;&gt;<i> <A HREF="https://groups.google.com/a/onosproject.org/d/msgid/brigade-p4/C51D008B-728A-4591-8CA7-EFD77B8FBB2A%40opennetworking.org">https://groups.google.com/a/onosproject.org/d/msgid/brigade-p4/C51D008B-728A-4591-8CA7-EFD77B8FBB2A%40opennetworking.org</A>
</I>&gt;&gt;<i> &lt;<A HREF="https://groups.google.com/a/onosproject.org/d/msgid/brigade-p4/C51D008B-728A-4591-8CA7-EFD77B8FBB2A%40opennetworking.org?utm_medium=email&amp;utm_source=footer">https://groups.google.com/a/onosproject.org/d/msgid/brigade-p4/C51D008B-728A-4591-8CA7-EFD77B8FBB2A%40opennetworking.org?utm_medium=email&amp;utm_source=footer</A>&gt;
</I>&gt;&gt;<i> .
</I>&gt;&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> --
</I>&gt;<i> Yi Tseng
</I>&gt;<i> Member of Technical Staff
</I>&gt;<i> Open Networking Foundation
</I>&gt;<i> <A HREF="https://www.opennetworking.org/">https://www.opennetworking.org/</A>
</I>&gt;<i>
</I>

-- 
Yi Tseng
Member of Technical Staff
Open Networking Foundation
<A HREF="https://www.opennetworking.org/">https://www.opennetworking.org/</A>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="https://lists.stratumproject.org/archives/stratum-dev/attachments/20200227/e1226a33/attachment-0001.html">https://lists.stratumproject.org/archives/stratum-dev/attachments/20200227/e1226a33/attachment-0001.html</A>&gt;
</PRE>




<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="000027.html">[stratum-dev] [brigade-p4] Stratum pre-built container
</A></li>
	<LI>Next message (by thread): <A HREF="000028.html">[stratum-dev] [brigade-p4] Stratum pre-built container
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#24">[ date ]</a>
              <a href="thread.html#24">[ thread ]</a>
              <a href="subject.html#24">[ subject ]</a>
              <a href="author.html#24">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.stratumproject.org/listinfo/stratum-dev">More information about the stratum-dev
mailing list</a><br>
</body></html>
