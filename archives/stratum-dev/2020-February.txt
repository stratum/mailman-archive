From bocon at opennetworking.org  Thu Feb 13 18:42:44 2020
From: bocon at opennetworking.org (Brian O'Connor)
Date: Thu, 13 Feb 2020 10:42:44 -0800
Subject: [stratum-dev] Today's Stratum Team Meeting
Message-ID: <CACKOpDmjZmJjPs56OBeOiwiC1BxJOrEP3k8Am1VLP88_d19=qw@mail.gmail.com>

Hi all,

Craig will be giving an overview of the work that he's done porting Stratum
to Smart NICs on today's call. We'll also do a quick demo status.

Agenda
https://docs.google.com/document/d/1ret8Vbnl-xbLgNsnDEH-jWP2_WwDYym4zDn6me3tiTA/edit?usp=sharing

Join Zoom Meeting at 11:30am PST
https://zoom.us/j/787501745

See you there!
Brian
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <https://lists.stratumproject.org/archives/stratum-dev/attachments/20200213/523a05b9/attachment.html>

From bocon at opennetworking.org  Thu Feb 20 10:30:57 2020
From: bocon at opennetworking.org (Brian O'Connor)
Date: Thu, 20 Feb 2020 02:30:57 -0800
Subject: [stratum-dev] Upcoming Stratum TST Meetings
Message-ID: <CACKOpDn1Nd-nDhE1GtxZGLqMVT_k-9=bNOzQJN2Ht2QU=u-bQQ@mail.gmail.com>

The next two meetings (today, 2/20) and next week (2/27) will be OCP demo
status meetings. The meeting on 3/5 will be cancelled due to a conflict
with OCP.

Please attend the calls if you are participating in the demos.

Thanks!
Brian
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <https://lists.stratumproject.org/archives/stratum-dev/attachments/20200220/fc167cdd/attachment.html>

From yi at opennetworking.org  Tue Feb 25 00:07:35 2020
From: yi at opennetworking.org (Yi Tseng)
Date: Mon, 24 Feb 2020 16:07:35 -0800
Subject: [stratum-dev] [brigade-p4] Stratum pre-built container
In-Reply-To: <C51D008B-728A-4591-8CA7-EFD77B8FBB2A@opennetworking.org>
References: <3219e60081e54a23950b45fb513ca36e@kau.se>
 <C51D008B-728A-4591-8CA7-EFD77B8FBB2A@opennetworking.org>
Message-ID: <CAOyFVR17KiGdfwZeD1ZyhJm1t5eh4Ar177gGA86HPSa_0TVRjA@mail.gmail.com>

[+stratum-dev at lists.stratumproject.org
<stratum-dev at lists.stratumproject.org>, remove p4-brigade list]

Hi Deval,

The public container images include a specific Barefoot Linux kernel module.

Now we only compile the module for kernels from OpenNetworkLiunx (3.16,
4.9, and 4.14)

If you want to run Stratum on different kernel (4.4.0-173-generic), you
need to compile the Barefoot SDE with the kernel header and run Stratum
directly on the OS

I've created a GitHub issue to support this request. And will make a PR to
support this case.
https://github.com/stratum/stratum/issues/140

Yi


On Mon, Feb 24, 2020 at 3:25 PM Carmelo Cascone <carmelo at opennetworking.org>
wrote:

> Hi Deval,
>
> I suggest you ask on the stratum-dev mailing list or Slack channel:
> https://wiki.opennetworking.org/display/COM/Stratum
>
> This mailing list is for discussions related to P4/P4Runtime support in
> ONOS.
>
> Thanks
> Carmelo
>
> On Feb 24, 2020, at 6:53 AM, Deval Bhamare <Deval.Bhamare at kau.se> wrote:
>
> Hi,
>
> I am trying to find Stratum pre-built docker image for Linux
> 4.4.0-173-generic x86_64 , however couldn't find it. Can you please tell me
> whether Stratum is not supported on Generic and only runs on ONL version?
>
> I tried *stratumproject/stratum-bf:8.9.1-4.14.49-OpenNetworkLinux* , but
> it failed with error:
>
> cat: /etc/onl/platform: No such file or directory
> Use default flag file
> Cannot find /usr/local/share/stratum/.json
>
>
> Maybe because the Linux doesn't support ONL? What may be the solution?
> Please let me know.
>
>
> Thanks,
> Deval
>
> --
> You received this message because you are subscribed to the Google Groups
> "P4 brigade" group.
> To unsubscribe from this group and stop receiving emails from it, send an
> email to brigade-p4+unsubscribe at onosproject.org.
> To view this discussion on the web visit
> https://groups.google.com/a/onosproject.org/d/msgid/brigade-p4/3219e60081e54a23950b45fb513ca36e%40kau.se
> <https://groups.google.com/a/onosproject.org/d/msgid/brigade-p4/3219e60081e54a23950b45fb513ca36e%40kau.se?utm_medium=email&utm_source=footer>
> .
>
>
> --
> You received this message because you are subscribed to the Google Groups
> "P4 brigade" group.
> To unsubscribe from this group and stop receiving emails from it, send an
> email to brigade-p4+unsubscribe at onosproject.org.
> To view this discussion on the web visit
> https://groups.google.com/a/onosproject.org/d/msgid/brigade-p4/C51D008B-728A-4591-8CA7-EFD77B8FBB2A%40opennetworking.org
> <https://groups.google.com/a/onosproject.org/d/msgid/brigade-p4/C51D008B-728A-4591-8CA7-EFD77B8FBB2A%40opennetworking.org?utm_medium=email&utm_source=footer>
> .
>


-- 
Yi Tseng
Member of Technical Staff
Open Networking Foundation
https://www.opennetworking.org/
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <https://lists.stratumproject.org/archives/stratum-dev/attachments/20200224/c3ddfb05/attachment.html>

From yi at opennetworking.org  Thu Feb 27 18:57:41 2020
From: yi at opennetworking.org (Yi Tseng)
Date: Thu, 27 Feb 2020 10:57:41 -0800
Subject: [stratum-dev] [brigade-p4] Stratum pre-built container
In-Reply-To: <b23068b17b02411bad50514261401a63@kau.se>
References: <3219e60081e54a23950b45fb513ca36e@kau.se>
 <C51D008B-728A-4591-8CA7-EFD77B8FBB2A@opennetworking.org>
 <CAOyFVR17KiGdfwZeD1ZyhJm1t5eh4Ar177gGA86HPSa_0TVRjA@mail.gmail.com>
 <b23068b17b02411bad50514261401a63@kau.se>
Message-ID: <CAOyFVR1VeaA+dPWT6x=yjX-qpqYV-UMMOMSvLrMRdLWWVqZFYQ@mail.gmail.com>

Hello, please see my reply *inline*

On Tue, Feb 25, 2020 at 1:21 AM Deval Bhamare <Deval.Bhamare at kau.se> wrote:

> Dear Yi,
>
>
> I appreciate your valuable input. I tried to build the  Stratum directly
> on the machine as well. It gave me an error. Details are below:
>
>
> *1. Build Stratum from scratch*: I have BF SDE 8.9.0 and I execute the
> command (first I executed it without
> incompatible_bzl_disallow_load_after_statement=false and it asked me to
> include that option in command):
>
>
> bazel build //stratum/hal/bin/barefoot:stratum_bf --define
> phal_with_onlp=false --define sde_ver=8.9.0
> --incompatible_bzl_disallow_load_after_statement=false
>
>
*Please use the stratum build development environment to build the Stratum.
We only support Bazel 0.23.2 now. And will move to 2.0 in the future.*
*https://github.com/stratum/stratum#development-environment
<https://github.com/stratum/stratum#development-environment>*


>
> It gave me the error:
>
>
> *ERROR:* /home/tofino/.cache/bazel/_bazel_tofino/f6d313d4f595c91e594b2a1b1a2579ea/external/io_bazel_rules_python/python/pip.bzl:39:25:
> Traceback (most recent call last):
> File
> "/home/tofino/.cache/bazel/_bazel_tofino/f6d313d4f595c91e594b2a1b1a2579ea/external/io_bazel_rules_python/python/pip.bzl",
> line 37
> repository_rule(<2 more arguments>)
> File
> "/home/tofino/.cache/bazel/_bazel_tofino/f6d313d4f595c91e594b2a1b1a2579ea/external/io_bazel_rules_python/python/pip.bzl",
> line 39, in repository_rule
> attr.label(allow_files = True, <2 more arguments>)
> 'single_file' is no longer supported. use allow_single_file instead. You
> can use --incompatible_disable_deprecated_attr_params=false to temporarily
> disable this check.
> *ERROR:* error loading package '': Extension file 'python/pip.bzl' has
> errors
> *ERROR:* error loading package '': Extension file 'python/pip.bzl' has
> errors
> INFO: Elapsed time: 0.101s
> INFO: 0 processes.
> *FAILED:* Build did NOT complete successfully (0 packages loaded)
>
>
>
> I also tried to build the Docker Image manually.
>
> *3. Build the docker image manually*: I tried to execute the command
> below, as per my kernel and SDE
>
>
> ./build-stratum-bf-container.sh bf-sde-8.9.0.tar linux-4.4.173.tar.gz
>
>
> However, it failed with error below. Where can I find *Linux ONL tar* for
> my linux kernel?
> Error:
>

*You should be able to find it from /usr/src/linux-headers-[your linux
kernel version]. *



> make: Entering directory '/usr/src/kernel-headers'
>
>   ERROR: Kernel configuration is invalid.
>          include/generated/autoconf.h or include/config/auto.conf are
> missing.
>          Run 'make oldconfig && make prepare' on kernel src to fix it.
>
>
>   WARNING: Symbol version dump ./Module.symvers
>            is missing; modules will have no dependencies and modversions.
>
>   Building modules, stage 2.
> scripts/Makefile.modpost:42: include/config/auto.conf: No such file or
> directory
> make[1]: *** No rule to make target 'include/config/auto.conf'.  Stop.
> Makefile:1439: recipe for target 'modules' failed
> make: Leaving directory '/usr/src/kernel-headers'
> make: *** [modules] Error 2
> The command '/bin/sh -c make -C /usr/src/kernel-headers M=$KDRV_DIR
> src=$KDRV_DIR modules &&     mv $KDRV_DIR/bf_kdrv.ko
> $SDE_INSTALL/lib/modules/bf_kdrv.ko' returned a non-zero code: 2
>
> Thanks,
>
>
> Deval.
> ------------------------------
> *From:* Yi Tseng <yi at opennetworking.org>
> *Sent:* Tuesday, February 25, 2020 2:07:35 AM
> *To:* Deval Bhamare
> *Cc:* stratum-dev at lists.stratumproject.org
> *Subject:* Re: [brigade-p4] Stratum pre-built container
>
> [+stratum-dev at lists.stratumproject.org
> <stratum-dev at lists.stratumproject.org>, remove p4-brigade list]
>
> Hi Deval,
>
> The public container images include a specific Barefoot Linux kernel
> module.
>
> Now we only compile the module for kernels from OpenNetworkLiunx (3.16,
> 4.9, and 4.14)
>
> If you want to run Stratum on different kernel (4.4.0-173-generic), you
> need to compile the Barefoot SDE with the kernel header and run Stratum
> directly on the OS
>
> I've created a GitHub issue to support this request. And will make a PR to
> support this case.
> https://github.com/stratum/stratum/issues/140
>
> Yi
>
>
> On Mon, Feb 24, 2020 at 3:25 PM Carmelo Cascone <
> carmelo at opennetworking.org> wrote:
>
>> Hi Deval,
>>
>> I suggest you ask on the stratum-dev mailing list or Slack channel:
>> https://wiki.opennetworking.org/display/COM/Stratum
>>
>> This mailing list is for discussions related to P4/P4Runtime support in
>> ONOS.
>>
>> Thanks
>> Carmelo
>>
>> On Feb 24, 2020, at 6:53 AM, Deval Bhamare <Deval.Bhamare at kau.se> wrote:
>>
>> Hi,
>>
>> I am trying to find Stratum pre-built docker image for Linux
>> 4.4.0-173-generic x86_64 , however couldn't find it. Can you please tell me
>> whether Stratum is not supported on Generic and only runs on ONL version?
>>
>> I tried *stratumproject/stratum-bf:8.9.1-4.14.49-OpenNetworkLinux* , but
>> it failed with error:
>>
>> cat: /etc/onl/platform: No such file or directory
>> Use default flag file
>> Cannot find /usr/local/share/stratum/.json
>>
>>
>> Maybe because the Linux doesn't support ONL? What may be the solution?
>> Please let me know.
>>
>>
>> Thanks,
>> Deval
>>
>> --
>> You received this message because you are subscribed to the Google Groups
>> "P4 brigade" group.
>> To unsubscribe from this group and stop receiving emails from it, send an
>> email to brigade-p4+unsubscribe at onosproject.org.
>> To view this discussion on the web visit
>> https://groups.google.com/a/onosproject.org/d/msgid/brigade-p4/3219e60081e54a23950b45fb513ca36e%40kau.se
>> <https://groups.google.com/a/onosproject.org/d/msgid/brigade-p4/3219e60081e54a23950b45fb513ca36e%40kau.se?utm_medium=email&utm_source=footer>
>> .
>>
>>
>> --
>> You received this message because you are subscribed to the Google Groups
>> "P4 brigade" group.
>> To unsubscribe from this group and stop receiving emails from it, send an
>> email to brigade-p4+unsubscribe at onosproject.org.
>> To view this discussion on the web visit
>> https://groups.google.com/a/onosproject.org/d/msgid/brigade-p4/C51D008B-728A-4591-8CA7-EFD77B8FBB2A%40opennetworking.org
>> <https://groups.google.com/a/onosproject.org/d/msgid/brigade-p4/C51D008B-728A-4591-8CA7-EFD77B8FBB2A%40opennetworking.org?utm_medium=email&utm_source=footer>
>> .
>>
>
>
> --
> Yi Tseng
> Member of Technical Staff
> Open Networking Foundation
> https://www.opennetworking.org/
>


-- 
Yi Tseng
Member of Technical Staff
Open Networking Foundation
https://www.opennetworking.org/
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <https://lists.stratumproject.org/archives/stratum-dev/attachments/20200227/e1226a33/attachment-0001.html>

From Deval.Bhamare at kau.se  Tue Feb 25 09:21:00 2020
From: Deval.Bhamare at kau.se (Deval Bhamare)
Date: Tue, 25 Feb 2020 09:21:00 +0000
Subject: [stratum-dev] [brigade-p4] Stratum pre-built container
In-Reply-To: <CAOyFVR17KiGdfwZeD1ZyhJm1t5eh4Ar177gGA86HPSa_0TVRjA@mail.gmail.com>
References: <3219e60081e54a23950b45fb513ca36e@kau.se>
 <C51D008B-728A-4591-8CA7-EFD77B8FBB2A@opennetworking.org>,
 <CAOyFVR17KiGdfwZeD1ZyhJm1t5eh4Ar177gGA86HPSa_0TVRjA@mail.gmail.com>
Message-ID: <b23068b17b02411bad50514261401a63@kau.se>

Dear Yi,


I appreciate your valuable input. I tried to build the  Stratum directly on the machine as well. It gave me an error. Details are below:


1. Build Stratum from scratch: I have BF SDE 8.9.0 and I execute the command (first I executed it without incompatible_bzl_disallow_load_after_statement=false and it asked me to include that option in command):


bazel build //stratum/hal/bin/barefoot:stratum_bf --define phal_with_onlp=false --define sde_ver=8.9.0 --incompatible_bzl_disallow_load_after_statement=false


It gave me the error:


ERROR: /home/tofino/.cache/bazel/_bazel_tofino/f6d313d4f595c91e594b2a1b1a2579ea/external/io_bazel_rules_python/python/pip.bzl:39:25: Traceback (most recent call last):
File "/home/tofino/.cache/bazel/_bazel_tofino/f6d313d4f595c91e594b2a1b1a2579ea/external/io_bazel_rules_python/python/pip.bzl", line 37
repository_rule(<2 more arguments>)
File "/home/tofino/.cache/bazel/_bazel_tofino/f6d313d4f595c91e594b2a1b1a2579ea/external/io_bazel_rules_python/python/pip.bzl", line 39, in repository_rule
attr.label(allow_files = True, <2 more arguments>)
'single_file' is no longer supported. use allow_single_file instead. You can use --incompatible_disable_deprecated_attr_params=false to temporarily disable this check.
ERROR: error loading package '': Extension file 'python/pip.bzl' has errors
ERROR: error loading package '': Extension file 'python/pip.bzl' has errors
INFO: Elapsed time: 0.101s
INFO: 0 processes.
FAILED: Build did NOT complete successfully (0 packages loaded)



I also tried to build the Docker Image manually.

3. Build the docker image manually: I tried to execute the command below, as per my kernel and SDE


./build-stratum-bf-container.sh bf-sde-8.9.0.tar linux-4.4.173.tar.gz


However, it failed with error below. Where can I find Linux ONL tar for my linux kernel?
Error:

make: Entering directory '/usr/src/kernel-headers'

  ERROR: Kernel configuration is invalid.
         include/generated/autoconf.h or include/config/auto.conf are missing.
         Run 'make oldconfig && make prepare' on kernel src to fix it.


  WARNING: Symbol version dump ./Module.symvers
           is missing; modules will have no dependencies and modversions.

  Building modules, stage 2.
scripts/Makefile.modpost:42: include/config/auto.conf: No such file or directory
make[1]: *** No rule to make target 'include/config/auto.conf'.  Stop.
Makefile:1439: recipe for target 'modules' failed
make: Leaving directory '/usr/src/kernel-headers'
make: *** [modules] Error 2
The command '/bin/sh -c make -C /usr/src/kernel-headers M=$KDRV_DIR src=$KDRV_DIR modules &&     mv $KDRV_DIR/bf_kdrv.ko $SDE_INSTALL/lib/modules/bf_kdrv.ko' returned a non-zero code: 2

Thanks,


Deval.

________________________________
From: Yi Tseng <yi at opennetworking.org>
Sent: Tuesday, February 25, 2020 2:07:35 AM
To: Deval Bhamare
Cc: stratum-dev at lists.stratumproject.org
Subject: Re: [brigade-p4] Stratum pre-built container

[+stratum-dev at lists.stratumproject.org<mailto:stratum-dev at lists.stratumproject.org>, remove p4-brigade list]

Hi Deval,

The public container images include a specific Barefoot Linux kernel module.

Now we only compile the module for kernels from OpenNetworkLiunx (3.16, 4.9, and 4.14)

If you want to run Stratum on different kernel (4.4.0-173-generic), you need to compile the Barefoot SDE with the kernel header and run Stratum directly on the OS

I've created a GitHub issue to support this request. And will make a PR to support this case.
https://github.com/stratum/stratum/issues/140

Yi


On Mon, Feb 24, 2020 at 3:25 PM Carmelo Cascone <carmelo at opennetworking.org<mailto:carmelo at opennetworking.org>> wrote:
Hi Deval,

I suggest you ask on the stratum-dev mailing list or Slack channel:
https://wiki.opennetworking.org/display/COM/Stratum

This mailing list is for discussions related to P4/P4Runtime support in ONOS.

Thanks
Carmelo

On Feb 24, 2020, at 6:53 AM, Deval Bhamare <Deval.Bhamare at kau.se<mailto:Deval.Bhamare at kau.se>> wrote:

Hi,

I am trying to find Stratum pre-built docker image for Linux 4.4.0-173-generic x86_64 , however couldn't find it. Can you please tell me whether Stratum is not supported on Generic and only runs on ONL version?

I tried stratumproject/stratum-bf:8.9.1-4.14.49-OpenNetworkLinux , but it failed with error:


cat: /etc/onl/platform: No such file or directory
Use default flag file
Cannot find /usr/local/share/stratum/.json

Maybe because the Linux doesn't support ONL? What may be the solution? Please let me know.


Thanks,
Deval

--
You received this message because you are subscribed to the Google Groups "P4 brigade" group.
To unsubscribe from this group and stop receiving emails from it, send an email to brigade-p4+unsubscribe at onosproject.org<mailto:brigade-p4+unsubscribe at onosproject.org>.
To view this discussion on the web visit https://groups.google.com/a/onosproject.org/d/msgid/brigade-p4/3219e60081e54a23950b45fb513ca36e%40kau.se<https://groups.google.com/a/onosproject.org/d/msgid/brigade-p4/3219e60081e54a23950b45fb513ca36e%40kau.se?utm_medium=email&utm_source=footer>.


--
You received this message because you are subscribed to the Google Groups "P4 brigade" group.
To unsubscribe from this group and stop receiving emails from it, send an email to brigade-p4+unsubscribe at onosproject.org<mailto:brigade-p4+unsubscribe at onosproject.org>.
To view this discussion on the web visit https://groups.google.com/a/onosproject.org/d/msgid/brigade-p4/C51D008B-728A-4591-8CA7-EFD77B8FBB2A%40opennetworking.org<https://groups.google.com/a/onosproject.org/d/msgid/brigade-p4/C51D008B-728A-4591-8CA7-EFD77B8FBB2A%40opennetworking.org?utm_medium=email&utm_source=footer>.


--
Yi Tseng
Member of Technical Staff
Open Networking Foundation
https://www.opennetworking.org/
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <https://lists.stratumproject.org/archives/stratum-dev/attachments/20200225/e0b38ace/attachment-0001.html>

From Deval.Bhamare at kau.se  Thu Feb 27 13:08:18 2020
From: Deval.Bhamare at kau.se (Deval Bhamare)
Date: Thu, 27 Feb 2020 13:08:18 +0000
Subject: [stratum-dev] [brigade-p4] Stratum pre-built container
In-Reply-To: <b23068b17b02411bad50514261401a63@kau.se>
References: <3219e60081e54a23950b45fb513ca36e@kau.se>
 <C51D008B-728A-4591-8CA7-EFD77B8FBB2A@opennetworking.org>,
 <CAOyFVR17KiGdfwZeD1ZyhJm1t5eh4Ar177gGA86HPSa_0TVRjA@mail.gmail.com>,
 <b23068b17b02411bad50514261401a63@kau.se>
Message-ID: <d4c6e0e026214dfbadda6279a1e86f2b@kau.se>

Dear Yi,


Sending a gentle reminder for query below.


Looks like my emails to Stratum-dev are blocked and have no way to reach the dev community.


I appreciate your help.


Regards,


Deval.



________________________________
From: Deval Bhamare
Sent: Tuesday, February 25, 2020 11:21 AM
To: Yi Tseng
Cc: stratum-dev at lists.stratumproject.org; devalb at gmail.com
Subject: Re: [brigade-p4] Stratum pre-built container


Dear Yi,


I appreciate your valuable input. I tried to build the  Stratum directly on the machine as well. It gave me an error. Details are below:


1. Build Stratum from scratch: I have BF SDE 8.9.0 and I execute the command (first I executed it without incompatible_bzl_disallow_load_after_statement=false and it asked me to include that option in command):


bazel build //stratum/hal/bin/barefoot:stratum_bf --define phal_with_onlp=false --define sde_ver=8.9.0 --incompatible_bzl_disallow_load_after_statement=false


It gave me the error:


ERROR: /home/tofino/.cache/bazel/_bazel_tofino/f6d313d4f595c91e594b2a1b1a2579ea/external/io_bazel_rules_python/python/pip.bzl:39:25: Traceback (most recent call last):
File "/home/tofino/.cache/bazel/_bazel_tofino/f6d313d4f595c91e594b2a1b1a2579ea/external/io_bazel_rules_python/python/pip.bzl", line 37
repository_rule(<2 more arguments>)
File "/home/tofino/.cache/bazel/_bazel_tofino/f6d313d4f595c91e594b2a1b1a2579ea/external/io_bazel_rules_python/python/pip.bzl", line 39, in repository_rule
attr.label(allow_files = True, <2 more arguments>)
'single_file' is no longer supported. use allow_single_file instead. You can use --incompatible_disable_deprecated_attr_params=false to temporarily disable this check.
ERROR: error loading package '': Extension file 'python/pip.bzl' has errors
ERROR: error loading package '': Extension file 'python/pip.bzl' has errors
INFO: Elapsed time: 0.101s
INFO: 0 processes.
FAILED: Build did NOT complete successfully (0 packages loaded)



I also tried to build the Docker Image manually.

3. Build the docker image manually: I tried to execute the command below, as per my kernel and SDE


./build-stratum-bf-container.sh bf-sde-8.9.0.tar linux-4.4.173.tar.gz


However, it failed with error below. Where can I find Linux ONL tar for my linux kernel?
Error:

make: Entering directory '/usr/src/kernel-headers'

  ERROR: Kernel configuration is invalid.
         include/generated/autoconf.h or include/config/auto.conf are missing.
         Run 'make oldconfig && make prepare' on kernel src to fix it.


  WARNING: Symbol version dump ./Module.symvers
           is missing; modules will have no dependencies and modversions.

  Building modules, stage 2.
scripts/Makefile.modpost:42: include/config/auto.conf: No such file or directory
make[1]: *** No rule to make target 'include/config/auto.conf'.  Stop.
Makefile:1439: recipe for target 'modules' failed
make: Leaving directory '/usr/src/kernel-headers'
make: *** [modules] Error 2
The command '/bin/sh -c make -C /usr/src/kernel-headers M=$KDRV_DIR src=$KDRV_DIR modules &&     mv $KDRV_DIR/bf_kdrv.ko $SDE_INSTALL/lib/modules/bf_kdrv.ko' returned a non-zero code: 2

Thanks,


Deval.

________________________________
From: Yi Tseng <yi at opennetworking.org>
Sent: Tuesday, February 25, 2020 2:07:35 AM
To: Deval Bhamare
Cc: stratum-dev at lists.stratumproject.org
Subject: Re: [brigade-p4] Stratum pre-built container

[+stratum-dev at lists.stratumproject.org<mailto:stratum-dev at lists.stratumproject.org>, remove p4-brigade list]

Hi Deval,

The public container images include a specific Barefoot Linux kernel module.

Now we only compile the module for kernels from OpenNetworkLiunx (3.16, 4.9, and 4.14)

If you want to run Stratum on different kernel (4.4.0-173-generic), you need to compile the Barefoot SDE with the kernel header and run Stratum directly on the OS

I've created a GitHub issue to support this request. And will make a PR to support this case.
https://github.com/stratum/stratum/issues/140

Yi


On Mon, Feb 24, 2020 at 3:25 PM Carmelo Cascone <carmelo at opennetworking.org<mailto:carmelo at opennetworking.org>> wrote:
Hi Deval,

I suggest you ask on the stratum-dev mailing list or Slack channel:
https://wiki.opennetworking.org/display/COM/Stratum

This mailing list is for discussions related to P4/P4Runtime support in ONOS.

Thanks
Carmelo

On Feb 24, 2020, at 6:53 AM, Deval Bhamare <Deval.Bhamare at kau.se<mailto:Deval.Bhamare at kau.se>> wrote:

Hi,

I am trying to find Stratum pre-built docker image for Linux 4.4.0-173-generic x86_64 , however couldn't find it. Can you please tell me whether Stratum is not supported on Generic and only runs on ONL version?

I tried stratumproject/stratum-bf:8.9.1-4.14.49-OpenNetworkLinux , but it failed with error:


cat: /etc/onl/platform: No such file or directory
Use default flag file
Cannot find /usr/local/share/stratum/.json

Maybe because the Linux doesn't support ONL? What may be the solution? Please let me know.


Thanks,
Deval

--
You received this message because you are subscribed to the Google Groups "P4 brigade" group.
To unsubscribe from this group and stop receiving emails from it, send an email to brigade-p4+unsubscribe at onosproject.org<mailto:brigade-p4+unsubscribe at onosproject.org>.
To view this discussion on the web visit https://groups.google.com/a/onosproject.org/d/msgid/brigade-p4/3219e60081e54a23950b45fb513ca36e%40kau.se<https://groups.google.com/a/onosproject.org/d/msgid/brigade-p4/3219e60081e54a23950b45fb513ca36e%40kau.se?utm_medium=email&utm_source=footer>.


--
You received this message because you are subscribed to the Google Groups "P4 brigade" group.
To unsubscribe from this group and stop receiving emails from it, send an email to brigade-p4+unsubscribe at onosproject.org<mailto:brigade-p4+unsubscribe at onosproject.org>.
To view this discussion on the web visit https://groups.google.com/a/onosproject.org/d/msgid/brigade-p4/C51D008B-728A-4591-8CA7-EFD77B8FBB2A%40opennetworking.org<https://groups.google.com/a/onosproject.org/d/msgid/brigade-p4/C51D008B-728A-4591-8CA7-EFD77B8FBB2A%40opennetworking.org?utm_medium=email&utm_source=footer>.


--
Yi Tseng
Member of Technical Staff
Open Networking Foundation
https://www.opennetworking.org/
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <https://lists.stratumproject.org/archives/stratum-dev/attachments/20200227/4a6c01e7/attachment-0001.html>

From Deval.Bhamare at kau.se  Fri Feb 28 11:19:08 2020
From: Deval.Bhamare at kau.se (Deval Bhamare)
Date: Fri, 28 Feb 2020 11:19:08 +0000
Subject: [stratum-dev] [brigade-p4] Stratum pre-built container
In-Reply-To: <CAOyFVR1VeaA+dPWT6x=yjX-qpqYV-UMMOMSvLrMRdLWWVqZFYQ@mail.gmail.com>
References: <3219e60081e54a23950b45fb513ca36e@kau.se>
 <C51D008B-728A-4591-8CA7-EFD77B8FBB2A@opennetworking.org>
 <CAOyFVR17KiGdfwZeD1ZyhJm1t5eh4Ar177gGA86HPSa_0TVRjA@mail.gmail.com>
 <b23068b17b02411bad50514261401a63@kau.se>,
 <CAOyFVR1VeaA+dPWT6x=yjX-qpqYV-UMMOMSvLrMRdLWWVqZFYQ@mail.gmail.com>
Message-ID: <66c9b15bb301460398895d0c56bb25c7@kau.se>

Thanks Yi.


I will try this.


Regards,


Deval.


________________________________
From: Yi Tseng <yi at opennetworking.org>
Sent: Thursday, February 27, 2020 8:57:41 PM
To: Deval Bhamare
Cc: stratum-dev at lists.stratumproject.org; devalb at gmail.com
Subject: Re: [brigade-p4] Stratum pre-built container

Hello, please see my reply inline

On Tue, Feb 25, 2020 at 1:21 AM Deval Bhamare <Deval.Bhamare at kau.se<mailto:Deval.Bhamare at kau.se>> wrote:

Dear Yi,


I appreciate your valuable input. I tried to build the  Stratum directly on the machine as well. It gave me an error. Details are below:


1. Build Stratum from scratch: I have BF SDE 8.9.0 and I execute the command (first I executed it without incompatible_bzl_disallow_load_after_statement=false and it asked me to include that option in command):


bazel build //stratum/hal/bin/barefoot:stratum_bf --define phal_with_onlp=false --define sde_ver=8.9.0 --incompatible_bzl_disallow_load_after_statement=false


Please use the stratum build development environment to build the Stratum. We only support Bazel 0.23.2 now. And will move to 2.0 in the future.
https://github.com/stratum/stratum#development-environment


It gave me the error:


ERROR: /home/tofino/.cache/bazel/_bazel_tofino/f6d313d4f595c91e594b2a1b1a2579ea/external/io_bazel_rules_python/python/pip.bzl:39:25: Traceback (most recent call last):
File "/home/tofino/.cache/bazel/_bazel_tofino/f6d313d4f595c91e594b2a1b1a2579ea/external/io_bazel_rules_python/python/pip.bzl", line 37
repository_rule(<2 more arguments>)
File "/home/tofino/.cache/bazel/_bazel_tofino/f6d313d4f595c91e594b2a1b1a2579ea/external/io_bazel_rules_python/python/pip.bzl", line 39, in repository_rule
attr.label(allow_files = True, <2 more arguments>)
'single_file' is no longer supported. use allow_single_file instead. You can use --incompatible_disable_deprecated_attr_params=false to temporarily disable this check.
ERROR: error loading package '': Extension file 'python/pip.bzl' has errors
ERROR: error loading package '': Extension file 'python/pip.bzl' has errors
INFO: Elapsed time: 0.101s
INFO: 0 processes.
FAILED: Build did NOT complete successfully (0 packages loaded)



I also tried to build the Docker Image manually.

3. Build the docker image manually: I tried to execute the command below, as per my kernel and SDE


./build-stratum-bf-container.sh bf-sde-8.9.0.tar linux-4.4.173.tar.gz


However, it failed with error below. Where can I find Linux ONL tar for my linux kernel?
Error:

You should be able to find it from /usr/src/linux-headers-[your linux kernel version].



make: Entering directory '/usr/src/kernel-headers'

  ERROR: Kernel configuration is invalid.
         include/generated/autoconf.h or include/config/auto.conf are missing.
         Run 'make oldconfig && make prepare' on kernel src to fix it.


  WARNING: Symbol version dump ./Module.symvers
           is missing; modules will have no dependencies and modversions.

  Building modules, stage 2.
scripts/Makefile.modpost:42: include/config/auto.conf: No such file or directory
make[1]: *** No rule to make target 'include/config/auto.conf'.  Stop.
Makefile:1439: recipe for target 'modules' failed
make: Leaving directory '/usr/src/kernel-headers'
make: *** [modules] Error 2
The command '/bin/sh -c make -C /usr/src/kernel-headers M=$KDRV_DIR src=$KDRV_DIR modules &&     mv $KDRV_DIR/bf_kdrv.ko $SDE_INSTALL/lib/modules/bf_kdrv.ko' returned a non-zero code: 2

Thanks,


Deval.

________________________________
From: Yi Tseng <yi at opennetworking.org<mailto:yi at opennetworking.org>>
Sent: Tuesday, February 25, 2020 2:07:35 AM
To: Deval Bhamare
Cc: stratum-dev at lists.stratumproject.org<mailto:stratum-dev at lists.stratumproject.org>
Subject: Re: [brigade-p4] Stratum pre-built container

[+stratum-dev at lists.stratumproject.org<mailto:stratum-dev at lists.stratumproject.org>, remove p4-brigade list]

Hi Deval,

The public container images include a specific Barefoot Linux kernel module.

Now we only compile the module for kernels from OpenNetworkLiunx (3.16, 4.9, and 4.14)

If you want to run Stratum on different kernel (4.4.0-173-generic), you need to compile the Barefoot SDE with the kernel header and run Stratum directly on the OS

I've created a GitHub issue to support this request. And will make a PR to support this case.
https://github.com/stratum/stratum/issues/140

Yi


On Mon, Feb 24, 2020 at 3:25 PM Carmelo Cascone <carmelo at opennetworking.org<mailto:carmelo at opennetworking.org>> wrote:
Hi Deval,

I suggest you ask on the stratum-dev mailing list or Slack channel:
https://wiki.opennetworking.org/display/COM/Stratum

This mailing list is for discussions related to P4/P4Runtime support in ONOS.

Thanks
Carmelo

On Feb 24, 2020, at 6:53 AM, Deval Bhamare <Deval.Bhamare at kau.se<mailto:Deval.Bhamare at kau.se>> wrote:

Hi,

I am trying to find Stratum pre-built docker image for Linux 4.4.0-173-generic x86_64 , however couldn't find it. Can you please tell me whether Stratum is not supported on Generic and only runs on ONL version?

I tried stratumproject/stratum-bf:8.9.1-4.14.49-OpenNetworkLinux , but it failed with error:


cat: /etc/onl/platform: No such file or directory
Use default flag file
Cannot find /usr/local/share/stratum/.json

Maybe because the Linux doesn't support ONL? What may be the solution? Please let me know.


Thanks,
Deval

--
You received this message because you are subscribed to the Google Groups "P4 brigade" group.
To unsubscribe from this group and stop receiving emails from it, send an email to brigade-p4+unsubscribe at onosproject.org<mailto:brigade-p4+unsubscribe at onosproject.org>.
To view this discussion on the web visit https://groups.google.com/a/onosproject.org/d/msgid/brigade-p4/3219e60081e54a23950b45fb513ca36e%40kau.se<https://groups.google.com/a/onosproject.org/d/msgid/brigade-p4/3219e60081e54a23950b45fb513ca36e%40kau.se?utm_medium=email&utm_source=footer>.


--
You received this message because you are subscribed to the Google Groups "P4 brigade" group.
To unsubscribe from this group and stop receiving emails from it, send an email to brigade-p4+unsubscribe at onosproject.org<mailto:brigade-p4+unsubscribe at onosproject.org>.
To view this discussion on the web visit https://groups.google.com/a/onosproject.org/d/msgid/brigade-p4/C51D008B-728A-4591-8CA7-EFD77B8FBB2A%40opennetworking.org<https://groups.google.com/a/onosproject.org/d/msgid/brigade-p4/C51D008B-728A-4591-8CA7-EFD77B8FBB2A%40opennetworking.org?utm_medium=email&utm_source=footer>.


--
Yi Tseng
Member of Technical Staff
Open Networking Foundation
https://www.opennetworking.org/


--
Yi Tseng
Member of Technical Staff
Open Networking Foundation
https://www.opennetworking.org/
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <https://lists.stratumproject.org/archives/stratum-dev/attachments/20200228/374c347b/attachment-0001.html>

